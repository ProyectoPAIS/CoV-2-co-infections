from vcffixer import reduce_seqs,fix_lines
test_lines = """MN996528.1	28281	.	A	T	153056.73	.	AC=6;AF=1.00;AN=6;BaseQRankSum=-1.048e+00;DP=3510;ExcessHet=0.0000;FS=0.000;MLEAC=6;MLEAF=1.00;MQ=59.99;MQRankSum=0.00;QD=25.00;ReadPosRankSum=0.869;SOR=0.349	GT:AD:DP:GQ:PGT:PID:PL:PS	1/1:0,1007:1009:99:.:.:46003,3112,0	1|1:1,1215:1216:99:1|1:28280_G_C:54166,3615,0:28280	0/0:0,1157:1159:99:.:.:52901,3579,0
MN996528.1	28282	.	T	A	125013.73	.	AC=6;AF=1.00;AN=6;BaseQRankSum=-1.021e+00;DP=3513;ExcessHet=0.0000;FS=0.000;MLEAC=6;MLEAF=1.00;MQ=59.99;MQRankSum=-3.300e-02;QD=29.56;ReadPosRankSum=0.936;SOR=0.559	GT:AD:DP:GQ:PGT:PID:PL:PS	1/1:0,1007:1009:99:.:.:46003,3112,0	1|1:3,1210:1213:99:1|1:28280_G_C:53911,3556,0:28280	1|1:0,1156:1158:99:1|1:28280_G_C:52867,3576,0:28280
MN996528.1	28881	.	G	A	156874.73	.	AC=6;AF=1.00;AN=6;BaseQRankSum=3.10;DP=5754;ExcessHet=0.0000;FS=0.000;MLEAC=6;MLEAF=1.00;MQ=59.99;MQRankSum=0.00;QD=30.49;ReadPosRankSum=2.72;SOR=0.644	GT:AD:DP:GQ:PGT:PID:PL:PS	1/1:3,1523:1532:99:.:.:64341,4583,0	1/1:0,1841:1849:99:.:.:87738,5911,0	0|0:0,1778:1993:99:1|1:28881_G_*:81941,5553,0:28881
MN996528.1	28882	.	G	A	158086.73	.	AC=6;AF=1.00;AN=6;DP=5772;ExcessHet=0.0000;FS=0.000;MLEAC=6;MLEAF=1.00;MQ=59.99;QD=30.69;SOR=0.905	GT:AD:DP:GQ:PGT:PID:PL:PS	1/1:0,1533:1539:99:.:.:72516,4913,0	1/1:0,1841:1849:99:.:.:87737,5910,0	1|1:0,1777:1992:99:1|1:28881_G_*:81948,5551,0:28881
MN996528.1	28883	.	G	C	160896.73	.	AC=6;AF=1.00;AN=6;DP=5825;ExcessHet=0.0000;FS=0.000;MLEAC=6;MLEAF=1.00;MQ=59.99;QD=31.04;SOR=0.917	GT:AD:DP:GQ:PGT:PID:PL:PS	1/1:0,1538:1544:99:.:.:66153,4658,0	1/1:0,1867:1872:99:.:.:87762,5902,0	1|1:0,1779:1994:99:1|1:28881_G_*:82012,5556,0:28881
MN996528.1	28977	.	C	T	148635.73	.	AC=6;AF=1.00;AN=6;BaseQRankSum=-1.185e+00;DP=4881;ExcessHet=0.0000;FS=0.000;MLEAC=6;MLEAF=1.00;MQ=60.00;MQRankSum=0.00;QD=31.50;ReadPosRankSum=-1.286e+00;SOR=0.554	GT:AD:DP:GQ:PL	1/1:0,1453:1456:99:45492,4335,0	1/1:1,1607:1610:99:50750,4770,0	1/1:0,1658:1665:99:52407,4966,0
MN996528.1	28281	.	A	T	153056.73	.	AC=6;AF=1.00;AN=6;BaseQRankSum=-1.048e+00;DP=3510;ExcessHet=0.0000;FS=0.000;MLEAC=6;MLEAF=1.00;MQ=59.99;MQRankSum=0.00;QD=25.00;ReadPosRankSum=0.869;SOR=0.349	GT:AD:DP:GQ:PGT:PID:PL:PS	1/1:0,1007:1009:99:.:.:46003,3112,0	0|1:1,1215:1216:99:1|1:28280_G_C:54166,3615,0:28280	0/0:0,1157:1159:99:.:.:52901,3579,0
MN996528.1	28282	.	T	A	125013.73	.	AC=6;AF=1.00;AN=6;BaseQRankSum=-1.021e+00;DP=3513;ExcessHet=0.0000;FS=0.000;MLEAC=6;MLEAF=1.00;MQ=59.99;MQRankSum=-3.300e-02;QD=29.56;ReadPosRankSum=0.936;SOR=0.559	GT:AD:DP:GQ:PGT:PID:PL:PS	1/1:0,1007:1009:99:.:.:46003,3112,0	1|1:3,1210:1213:99:1|1:28280_G_C:53911,3556,0:28280	0|0:0,1156:1158:99:0|0:28280_G_C:52867,3576,0:28280
MN996528.1	28881	.	G	A	156874.73	.	AC=6;AF=1.00;AN=6;BaseQRankSum=3.10;DP=5754;ExcessHet=0.0000;FS=0.000;MLEAC=6;MLEAF=1.00;MQ=59.99;MQRankSum=0.00;QD=30.49;ReadPosRankSum=2.72;SOR=0.644	GT:AD:DP:GQ:PGT:PID:PL:PS	1/1:3,1523:1532:99:.:.:64341,4583,0	1/1:0,1841:1849:99:.:.:87738,5911,0	0|0:0,1778:1993:99:1|1:28881_G_*:81941,5553,0:28881
MN996528.1	28882	.	G	A	158086.73	.	AC=6;AF=1.00;AN=6;DP=5772;ExcessHet=0.0000;FS=0.000;MLEAC=6;MLEAF=1.00;MQ=59.99;QD=30.69;SOR=0.905	GT:AD:DP:GQ:PGT:PID:PL:PS	1/1:0,1533:1539:99:.:.:72516,4913,0	0/1:0,1841:1849:99:.:.:87737,5910,0	0|0:0,1777:1992:99:1|1:28881_G_*:81948,5551,0:28881
MN996528.1	28883	.	G	C	160896.73	.	AC=6;AF=1.00;AN=6;DP=5825;ExcessHet=0.0000;FS=0.000;MLEAC=6;MLEAF=1.00;MQ=59.99;QD=31.04;SOR=0.917	GT:AD:DP:GQ:PGT:PID:PL:PS	1/1:0,1538:1544:99:.:.:66153,4658,0	1/1:0,1867:1872:99:.:.:87762,5902,0	0|0:0,1779:1994:99:1|1:28881_G_*:82012,5556,0:28881
""".split("\n")

def test_reduce_seqs():
    assert "GG", reduce_seqs("G","G",1)   # 2 single nucleotides, one next to the other
    assert "GG", reduce_seqs("GG","G",1)  # an insertion, that overlaps with the following
    assert "AAC", reduce_seqs("AA","C",2) # 2 nucleotides at a distance of 2 with the third

def test_fix_lines_simple():
    print(fix_lines(test_lines[:2],["s1","s2","s3"]))
    print(fix_lines(test_lines[2:5],["s1","s2","s3"]))
    print(fix_lines(test_lines[6:8],["s1","s2","s3"]))
    print(fix_lines(test_lines[8:11],["s1","s2","s3"]))

test_reduce_seqs()
test_fix_lines_simple()